<html>
<head><title>Rollocontrol</title>

</head>
<body>
<script type="text/javascript">

function getCurSecOfDay() {
	var d = new Date();
    return d.getHours() * 3600 + d.getMinutes() * 60 + d.getSeconds();
}

function getCurWeekDay() {
	var d = new Date().getDay();
	if (d == 0)
		return 6;
	else 
		return d - 1;	
}

function secOfDay2String(sod) {                
	var h = Math.floor(sod / 3600), min = Math.floor((sod % 3600) / 60), sec = sod % 60;
	if (h < 10)   {h   = "0"+h;}
	if (min < 10) {min = "0"+min;}
	if (sec < 10) {sec = "0"+sec;}
	return h + ":" + min + ":" + sec; 
}

function recursiveList(obj) {
	var t = "<ul>";
	for (i in obj) {
		t += "<li>" + i;
		if (obj[i] instanceof Object) {
			t += recursiveList(obj[i]);
		} else {
			t += " = " + obj[i]; 
		}
		t += "</li>";
	}
	t += "</ul>";
	return t;	
}
/*
function ajax(a,b,c){ // Url, Callback, just a placeholder
 c = new XMLHttpRequest;
 c.open('GET',a);
 c.onload=b;
 c.send()
}

/ajax?cmd=setTime&sod=20344&weekDay=3
*/

function request(callback) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onreadystatechange = function(){
        if (httpRequest.readyState === 4) {// request is done
            if (httpRequest.status === 200) {// successfully
                callback(httpRequest.responseText);// we're calling our method
            }
        }
    };    httpRequest.open('GET', "/ajax");
    httpRequest.send();
}

request(function(resp) {
	var myJson = JSON.parse(resp); 	
	document.write(secOfDay2String(300) + "<br>");
	document.write(secOfDay2String(myJson.time.secoundsOfDay) + "<br>");
	document.write(secOfDay2String(getCurSecOfDay()) + "<br>");
	document.write(getCurWeekDay() + "<br>");
	document.write(recursiveList(myJson));
});

</script>
<body>
</html>